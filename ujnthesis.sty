\ProvidesPackage{ujnthesis}

\RequirePackage[dvipsnames]{xcolor}
\RequirePackage{pdfpages, setspace, graphicx, dashrule, booktabs, listings, setspace, amsmath}

\setmonofont{Times New Roman}
\lstset{
	columns = fullflexible,
	language = C,
	frame = trbl,
	showstringspaces = false,
	breaklines = true,
	extendedchars = false,
	texcl = true,
	basicstyle = \small\linespread{1},
	tabsize = 4,
	backgroundcolor = \color[RGB]{242,242,242},
	keywordstyle = {\color{blue}\bfseries},
	stringstyle = {\color{Maroon}},
	commentstyle = {\color{OliveGreen}}
}

\RequirePackage[a4paper, top = 2.5cm, bottom = 2.5cm, left = 3cm, right = 2.5cm]{geometry}

\RequirePackage{fontspec}
\setmainfont{Times New Roman}[BoldFont = *-Bold]

\RequirePackage[scale = 1, angle = 90, color = black, hshift = -5mm, vshift = 8.8cm]{background}
\backgroundsetup{contents = {\hdashrule[0cm]{26.85cm}{0pt}{0pt}}}

\newcommand{\setblindingline}{\backgroundsetup{contents={\hdashrule[0cm]{26.85cm}{1pt}{1pt}}}}
\newcommand{\unsetblindingline}{\backgroundsetup{contents = {}}}

\renewcommand{\thefigure}{\thesection{}.\arabic{figure}}
\renewcommand{\thetable}{\thesection{}.\arabic{table}}
\renewcommand{\theequation}{\thesection{}.\arabic{equation}}

\RequirePackage{fancyhdr}
\pagestyle{fancy}
\fancyhead{}
\chead{\small{济南大学毕业设计}\fontsize{2pt}{7pt}\selectfont{\\ \quad}}

\renewcommand\headrulewidth{1.6pt}
\renewcommand\footrulewidth{1.6pt}

\newcommand{\setfancylength}{
	\setlength{\voffset}{3mm}
	\setlength{\headheight}{7mm}
	\setlength{\headsep}{5mm}
	\setlength{\textheight}{245mm}
	%\setlength{\footsep}{3mm}
	\setlength{\footskip}{5mm}
}

\newcommand{\unsetfancylength}{
	\setlength{\voffset}{0mm}
	\setlength{\headheight}{0mm}
	\setlength{\headsep}{0mm}
	\setlength{\footskip}{0mm}
}

\RequirePackage{titletoc}
\titlecontents{section}
	[1em]
	{\normalsize\vspace{0em}}
	{\contentslabel{1em}}
	{\hspace*{-1em}}
	{~\titlerule*[0.4pc]{.}~\contentspage}
\titlecontents{subsection}
	[4em]
	{\normalsize\vspace{0em}}
	{\contentslabel{2em}}
	{\hspace*{0em}}
	{~\titlerule*[0.4pc]{.}~\contentspage}
\titlecontents{subsubsection}
	[6.5em]
	{\normalsize\vspace{0em}}
	{\contentslabel{2.5em}}
	{\hspace*{0em}}
	{~\titlerule*[0.4pc]{.}~\contentspage}

\renewcommand{\contentsname}{\begin{spacing}{1.2}\small{\quad\\ \quad\\ }\large{目\qquad 录\\}\end{spacing}}

\ctexset{
	section/aftername = {\enspace},
	subsection/aftername = {\enspace},
	subsubsection/aftername = {\enspace},
	bibname = {参\enspace 考\enspace 文\enspace 献}
}


\fancypagestyle{ujnabstract} % 定义中文摘要格式
{
	\ctexset{
		section/format = {\large\heiti\centering},
		section/beforeskip = {2em},
		section/afterskip = {21pt}
	}
	\pagenumbering{Roman} % 罗马数字页码
	\fancyfoot[C]{\fontsize{2pt}{7pt}\selectfont{\\ \quad}\small{--\enspace\thepage{}\enspace--}} % 页码居中左右两杠

	\newcommand\cnkeywords[1]{{\\ \quad\small{\textbf{\\ 关键词：}}} ##1}
}

\fancypagestyle{ujnabstract*} % 定义英文摘要格式
{
	\ctexset{
		section/format = {\zihao{3}\centering\bfseries},
		section/beforeskip = {1.5em},
		section/afterskip = {21pt}
	} % 标题格式
	\fancyfoot[C]{\fontsize{2pt}{7pt}\selectfont{\\ \quad}\small{--\enspace\thepage{}\enspace--}} % 页码居中左右两杠

	\newcommand\enkeywords[1]{\quad \\\small{\bfseries{Key words：}} ##1}
}

\fancypagestyle{ujncontent} % 定义目录格式
{
	\fancyfoot{} % 清除页脚
	\ctexset{
		section/nameformat = {\large\heiti\centering}
	} % 标题格式
}

\fancypagestyle{ujnbody} % 定义正文格式
{
	\ctexset{
		section/format += {
			\clearpage
			\setcounter{table}{0}
			\setcounter{figure}{0}
			\setcounter{equation}{0}
		},
		section/titleformat = {\large\heiti},
		section/numberformat = {\large\bfseries},
		section/beforeskip = 5pt,
		section/afterskip = 1.5em,
		subsection/titleformat = {\zihao{4}\heiti},
		subsection/numberformat = {\zihao{4}\bfseries},
		subsection/beforeskip = 0.5em,
		subsection/afterskip = 0.5em,
		subsubsection/titleformat = {\normalsize\heiti},
		subsubsection/numberformat = {\normalsize\bfseries},
		subsubsection/beforeskip = 0.5em,
		subsubsection/afterskip = 0.5em
	} % 标题格式
	\pagenumbering{arabic} % 数字页码
	\fancyfoot[C]{\small{--\enspace\thepage{}\enspace--}} % 页码居中左右两杠
}

\fancypagestyle{ujnothers}{}

\newenvironment{ujnabstract}{\ctexset{section/numbering = false}\section*{\quad\\}}{}
\newenvironment{ujnabstract*}{\ctexset{section/numbering = false}\small{\quad\\}}{}
\newenvironment{ujnbody}{\ctexset{section/numbering = true}}{}
\newenvironment{ujnconclusion}{\ctexset{section/numbering = false}}{}
\newenvironment{ujnreference}{\ctexset{section/numbering = false}}{}
\newenvironment{ujnthanks}{\ctexset{section/numbering = false}}{}
\newenvironment{ujnappendix}{\ctexset{section/numbering = false}}{}