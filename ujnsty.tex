\usepackage{pdfpages, setspace, graphicx, tikz, afterpage, booktabs}
\usepackage[a4paper, top = 2.5cm, bottom = 2.5cm, left = 3cm, right = 2.5cm, showframe]{geometry}

\usepackage{fontspec}
\setmainfont{Times New Roman}[BoldFont = *-Bold]

\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhead{}
\chead{\small{济南大学毕业设计}\fontsize{2pt}{7pt}\selectfont{\\ \quad}}
\renewcommand\headrulewidth{1.6pt}
\renewcommand\footrulewidth{1.6pt}

\setlength{\voffset}{-10mm}
\setlength{\topmargin}{0mm}
\setlength{\headheight}{5mm}
\setlength{\headsep}{5mm}
\setlength{\footskip}{10mm}

\usepackage{titletoc}
\titlecontents{section}
	[1em]
	{\normalsize\vspace{0em}}
	{\contentslabel{1em}}
	{\hspace*{-1em}}
	{~\titlerule*[0.4pc]{.}~\contentspage}
\titlecontents{subsection}
	[4em]
	{\normalsize\vspace{0em}}
	{\contentslabel{2em}}
	{\hspace*{0em}}
	{~\titlerule*[0.4pc]{.}~\contentspage}
\titlecontents{subsubsection}
	[6.5em]
	{\normalsize\vspace{0em}}
	{\contentslabel{2.5em}}
	{\hspace*{0em}}
	{~\titlerule*[0.4pc]{.}~\contentspage}

\renewcommand{\contentsname}{\small{\quad\\ \quad\\ }\large{目\qquad 录\\}}

\tiny\newsavebox{\blindingbox}
\sbox{\blindingbox}{\parbox{1em}{\tikz{\draw[densely dotted](0,-26.25)--(0,1)}}}
\newcommand{\putblindingline}{\reversemarginpar\marginpar{\vspace{-1.3cm}\hspace{0.4cm}\usebox{\blindingbox}}}

\ctexset{
	section/aftername = {\enspace},
	subsection/aftername = {\enspace},
	subsubsection/aftername = {\enspace}
}

\fancypagestyle{ujnabstract} % 定义中文摘要格式
{
	\ctexset{
		section/format = {\large\heiti\centering}
	}
	\pagenumbering{Roman} % 罗马数字页码
	\fancyfoot[C]{- \thepage{} -} % 页码居中左右两杠

	\newcommand\cnkeywords[1]{\\ \quad\small{\bfseries{\\ 关键词:}} ##1}
}

\fancypagestyle{ujnabstract*} % 定义英文摘要格式
{
	\ctexset{
		section/format = {\large\centering\bfseries}
	} % 标题格式
	\fancyfoot[C]{- \thepage{} -} % 页码居中左右两杠

	\newcommand\enkeywords[1]{\\ \quad\small{\bfseries{\\ Key words:}} ##1}
}

\fancypagestyle{ujncontent} % 定义目录格式
{
	\fancyfoot{} % 清除页脚
	\ctexset{
		section/nameformat = {\large\heiti\centering}
	} % 标题格式
}

\fancypagestyle{ujnbody} % 定义正文格式
{
	\ctexset{
		section/format += \clearpage,
		section/titleformat = {\large\heiti},
		section/numberformat = {\large\bfseries},
		section/beforeskip = 0ex,
		section/afterskip = 1.5em,
		subsection/titleformat = {\zihao{4}\heiti},
		subsection/numberformat = {\zihao{4}\bfseries},
		subsection/beforeskip = 0.5em,
		subsection/afterskip = 0.5em,
		subsubsection/titleformat = {\normalsize\heiti},
		subsubsection/numberformat = {\normalsize\bfseries},
		subsubsection/beforeskip = 0.5em,
		subsubsection/afterskip = 0.5em
	} % 标题格式
	\pagenumbering{arabic} % 数字页码
	\fancyfoot[C]{- \thepage{} -} % 页码居中左右两杠
}

%\afterpage{\putblindingline}

\fancypagestyle{ujnothers} % 定义其他格式
{}